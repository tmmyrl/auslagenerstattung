<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auslagenerstattung Hole of Fame e.V.</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Modern Indigo -->
    <!-- Application Structure Plan: A task-oriented, single-page form application. The structure guides the user logically from personal details to itemized expenses, with dynamic table rows for easy entry. An automatically calculated total provides immediate feedback. The final step is a clear call-to-action to print the form. This structure was chosen to streamline the data entry process, minimize user error by automating calculations, and provide a clean, print-ready output, directly addressing the core task of submitting an expense claim efficiently. -->
    <!-- Visualization & Content Choices: Report Info: Expense items -> Goal: Organize/Collect -> Presentation: Interactive HTML Table -> Interaction: Add/Delete rows via JS, real-time sum calculation -> Justification: A table is the most intuitive way to present itemized data. Dynamic rows and auto-calculation are significant usability improvements over a static form. Library/Method: Vanilla JS for all interactions. Report Info: Total sum -> Goal: Inform -> Presentation: Read-only display field -> Interaction: Updates automatically -> Justification: Provides immediate, error-free feedback to the user. Library/Method: Vanilla JS. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        @page {
            size: A4;
            margin: 1cm;
        }
        body {
            font-family: 'Inter', sans-serif;
        }
        .form-input {
            @apply w-full rounded-md border border-gray-400 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm;
        }
        .btn {
            @apply inline-flex items-center justify-center rounded-md border border-transparent px-4 py-2 text-sm font-medium shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2;
        }
        .btn-primary {
            @apply bg-indigo-600 text-white hover:bg-indigo-700 focus:ring-indigo-500;
        }
        .btn-secondary {
            @apply bg-gray-200 text-gray-700 hover:bg-gray-300 focus:ring-gray-400;
        }
        .btn-danger {
            @apply bg-red-600 text-white hover:bg-red-700 focus:ring-red-500;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
        }
        .modal-content {
            background-color: #fefefe;
            margin: 10% auto;
            padding: 24px;
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
        }
        @media print {
            .no-print {
                display: none;
            }
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
                height: 29.7cm;
                width: 21cm;
                margin: 0;
                padding: 1cm;
            }
            .print-container {
                box-shadow: none;
                border: none;
                margin: 0;
                padding: 0;
                height: 100%;
                display: flex;
                flex-direction: column;
                justify-content: space-between;
            }
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div id="app-container" class="container mx-auto max-w-4xl p-4 sm:p-6 lg:p-8">
        <div class="bg-white p-8 rounded-xl shadow-lg print-container">
            
            <header class="mb-8 text-center">
                <h1 class="text-2xl font-bold text-gray-900 sm:text-3xl">Auslagenerstattung</h1>
                <div id="verein-info" class="mt-2 text-sm text-gray-600">
                    <p class="font-semibold">Hole of Fame e.V.</p>
                    <p>Königsbrücker Str. 39, 01099 Dresden</p>
                </div>
            </header>

            <main>
                <form id="reimbursement-form">
                    <section id="applicant-details" class="mb-8">
                        <h2 class="text-lg font-semibold border-b pb-2 mb-4 text-gray-700">Deine Angaben</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="name" class="block text-sm font-medium text-gray-700">Name</label>
                                <input type="text" id="name" class="form-input mt-1">
                            </div>
                            <div>
                                <label for="address" class="block text-sm font-medium text-gray-700">Anschrift</label>
                                <textarea id="address" class="form-input mt-1 resize-y min-h-[50px]"></textarea>
                            </div>
                            <div>
                                <label for="date" class="block text-sm font-medium text-gray-700">Datum</label>
                                <input type="date" id="date" class="form-input mt-1">
                            </div>
                        </div>
                    </section>
                    
                    <section id="expense-items" class="mb-8">
                        <div class="flex flex-col sm:flex-row justify-between sm:items-center border-b pb-2 mb-4">
                             <h2 class="text-lg font-semibold text-gray-700">Aufstellung deiner Ausgaben</h2>
                             <button type="button" id="add-row" class="btn btn-primary mt-2 sm:mt-0 no-print">
                                 <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" /></svg>
                                 Posten hinzufügen
                             </button>
                        </div>
                        <p class="text-sm text-gray-500 mb-4 no-print">Füge hier alle Ausgaben hinzu. Die Gesamtsumme wird automatisch berechnet.</p>
                        <div class="overflow-x-auto">
                            <table class="min-w-full">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="py-2 px-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Datum</th>
                                        <th class="py-2 px-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Beschreibung & Zweck</th>
                                        <th class="py-2 px-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Betrag (€)</th>
                                        <th class="w-16 py-2 px-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider no-print">Aktion</th>
                                    </tr>
                                </thead>
                                <tbody id="expense-table-body">
                                </tbody>
                            </table>
                        </div>
                    </section>

                    <section id="summary" class="mb-8 flex justify-end">
                        <div class="flex items-center gap-4">
                            <label for="total-amount" class="text-lg font-semibold text-gray-700">Gesamtsumme:</label>
                            <input type="text" id="total-amount" class="form-input w-32 text-right font-bold text-lg bg-gray-100" readonly value="0.00 €">
                        </div>
                    </section>

                    <section id="bank-details" class="mb-8">
                         <h2 class="text-lg font-semibold border-b pb-2 mb-4 text-gray-700">Bankverbindung für die Erstattung</h2>
                         <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="iban" class="block text-sm font-medium text-gray-700">IBAN</label>
                                <input type="text" id="iban" class="form-input mt-1 w-full" maxlength="30" placeholder="DE00 0000 0000 0000 0000 00">
                            </div>
                            <div>
                                <label for="bank-name" class="block text-sm font-medium text-gray-700">Name der Bank</label>
                                <input type="text" id="bank-name" class="form-input mt-1">
                            </div>
                        </div>
                    </section>

                    <section id="declaration" class="mt-12 pt-8 border-t-2 border-dashed">
                        <p class="text-sm text-gray-600 mb-8">
                            Ich bestätige hiermit, dass die oben aufgeführten Ausgaben ausschließlich im Sinne und zum Wohle des Vereins getätigt wurden. Ich versichere, dass meine Angaben korrekt und vollständig sind. Bitte füge diesem Formular alle Originalbelege bei. Ohne Belege ist eine Erstattung nicht möglich.
                        </p>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-16">
                            <div class="border-t border-gray-400 pt-2">
                                <p class="text-sm text-gray-700">Unterschrift Mitglied</p>
                            </div>
                             <div class="border-t border-gray-400 pt-2">
                                <p class="text-sm text-gray-700">Unterschrift Vorstand / Kassenwart (Freigabe)</p>
                            </div>
                        </div>
                    </section>
                </form>

                <footer class="mt-12 text-center no-print">
                    <div class="flex justify-center gap-4">
                        <button type="button" id="print-form" class="btn btn-primary">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5 4v3H4a2 2 0 00-2 2v6a2 2 0 002 2h12a2 2 0 002-2V9a2 2 0 00-2-2h-1V4a2 2 0 00-2-2H7a2 2 0 00-2 2zm8 0H7v3h6V4zm0 8H7v4h6v-4z" clip-rule="evenodd" /></svg>
                            Formular drucken
                        </button>
                        <button type="button" id="reset-form" class="btn btn-secondary">Formular zurücksetzen</button>
                    </div>
                </footer>
            </main>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const expenseTableBody = document.getElementById('expense-table-body');
            const addRowButton = document.getElementById('add-row');
            const totalAmountInput = document.getElementById('total-amount');
            const printButton = document.getElementById('print-form');
            const resetButton = document.getElementById('reset-form');
            const mainForm = document.getElementById('reimbursement-form');
            const dateInput = document.getElementById('date');
            
            const ibanInput = document.getElementById('iban');

            dateInput.valueAsDate = new Date();

            const createRow = (data = {}) => {
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-200';
                row.innerHTML = `
                    <td class="px-3 py-2 whitespace-nowrap">
                        <input type="date" class="form-input expense-date" value="${data.datum || new Date().toISOString().slice(0, 10)}">
                    </td>
                    <td class="px-3 py-2">
                        <input type="text" class="form-input expense-description" placeholder="z.B. Büromaterial" value="${data.beschreibung || ''}">
                    </td>
                    <td class="px-3 py-2 whitespace-nowrap">
                        <input type="number" class="form-input expense-amount text-right" placeholder="0.00" min="0" step="0.01" value="${data.betrag || ''}">
                    </td>
                    <td class="px-3 py-2 text-center no-print">
                        <button type="button" class="btn-danger p-2 rounded-full delete-row">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z" clip-rule="evenodd" /></svg>
                        </button>
                    </td>
                `;
                
                row.querySelector('.expense-amount').addEventListener('input', calculateTotal);
                row.querySelector('.delete-row').addEventListener('click', (e) => {
                    e.currentTarget.closest('tr').remove();
                    calculateTotal();
                });

                return row;
            };

            ibanInput.addEventListener('input', (e) => {
                const value = e.target.value.replace(/\s/g, '');
                const formattedValue = value.replace(/(.{4})/g, '$1 ').trim();
                e.target.value = formattedValue.toUpperCase();
            });
            
            const calculateTotal = () => {
                let total = 0;
                const amounts = expenseTableBody.querySelectorAll('.expense-amount');
                amounts.forEach(input => {
                    const value = parseFloat(input.value);
                    if (!isNaN(value)) {
                        total += value;
                    }
                });
                totalAmountInput.value = `${total.toFixed(2).replace('.', ',')} €`;
            };

            const appendRowsFromData = (data) => {
                if (!Array.isArray(data) || data.length === 0) {
                    return;
                }
                const currentRows = expenseTableBody.querySelectorAll('tr').length;
                if (currentRows > 1 || (currentRows === 1 && expenseTableBody.querySelector('.expense-amount').value !== '')) {
                    const newRows = document.createDocumentFragment();
                    data.forEach(item => newRows.appendChild(createRow(item)));
                    expenseTableBody.appendChild(newRows);
                } else {
                    expenseTableBody.innerHTML = '';
                    data.forEach(item => expenseTableBody.appendChild(createRow(item)));
                }
                calculateTotal();
            };

            addRowButton.addEventListener('click', () => {
                const newRow = createRow();
                expenseTableBody.appendChild(newRow);
            });

            printButton.addEventListener('click', () => {
                window.print();
            });
            
            resetButton.addEventListener('click', () => {
                mainForm.reset();
                expenseTableBody.innerHTML = '';
                const newRow = createRow();
                expenseTableBody.appendChild(newRow);
                dateInput.valueAsDate = new Date();
                calculateTotal();
            });

            const newRow = createRow();
            expenseTableBody.appendChild(newRow);
        });
    </script>
</body>
</html>
